Gozigen Gokigenz Web版 要件定義書（正式ルール準拠・ネオンTRONスタイル版）

1. プロジェクト概要

1.1 目的
ブラウザ上で動作する Gozigen Gokigenz（ゴジゲン・ゴキゲンズ）を開発する。
原型はゴブレットゴブラーズだが、デザイン・ブランド・UIはTRON風に再構築する。
HTML／CSS／JavaScriptのみの軽量SPAとして実装。
同一端末での2人対戦 と AI対戦（4段階の難易度）に対応。

1.2 デザインコンセプト
世界観：TRON（トロン） のような
  ネオンブルー（#00eaff付近）
  ネオングリーン（#4aff00付近）
を軸にした サイバーボードゲーム。
盤面・駒は「光の輪」や「発光プレート」をイメージ。
UIは黒背景（#000〜#050）に発光ラインを組み合わせる。

1.3 対象ユーザー
ボードゲーム好き
テック系デザインを好む層
子ども〜大人まで楽しめるカジュアルゲーム

2. ゲーム仕様（Gozigen Gokigenz 正式ルール）

2.1 基本ルール
3×3の盤面で行う二人用ゲーム。
各プレイヤーは自分の「光球駒（Glow Pieces）」を持つ。
駒は Large / Medium / Small の3サイズ。

手番でできる行動：
  ①置く：手持ちの光球駒を盤の空きマスに置く
  ②移動させる：盤上の自分の光球駒を別の空きマスに動かす
  ③かぶせる：盤上のコマ（自分のコマでも相手のコマでも良い）の上に、
              自分のより大きいコマをかぶせる

同じ色の光球を縦・横・斜めに3つ並べたら勝ち。

2.2 盤面
3×3 グリッド
発光ラインで枠を構築（ネオンブルー基調）
各マスはユニークID（例：cell-0〜8）

2.3 光球駒（Glow Pieces）

色設定（TRONスタイル）
  Player 1：ネオンブルー（#00eaff）
  Player 2：ネオングリーン（#4aff00）

サイズ
  Large（大）
  Medium（中）
  Small（小）

各サイズの駒数（正式ルール）
  Large：2個
  Medium：2個
  Small：2個
  ※各プレイヤーは合計6個の駒を持つ

駒が持つ属性
  id
  owner（P1 / P2）
  size
  location（reserve or board cell）

ビジュアル：発光円＋太いネオン輪郭線

2.4 Gobble（かぶせ）ルール【重要】

サイズ階層：Large ＞ Medium ＞ Small

かぶせる際の条件：
  ✓ 大きいコマは、それより小さいコマの上にかぶせられる
  ✓ 自分のコマでも相手のコマでも良い（どちらにもかぶせ可能）
  ✓ 同サイズ or 大きい駒の上 → NG

スタック構造で管理：
  最上位の駒のみ表示、下は非表示
  かぶせられたコマの下の中身は、外から見えない（記憶する必要がある）

2.5 駒の移動

盤上の自分の最前面の光球のみ動かせる。
移動先は：
  空きマス、または
  より小さい駒の上（自分/相手問わず）
移動後、元の場所に下層の駒があれば自動的に再表示される。

2.6 勝敗判定

3つ並んだラインの最上層がすべて P1 または P2 → 勝利
勝利時は勝ちラインを「発光アニメ」で強調表示
  （ブルーライン or グリーンラインが光り走る）

注意点：
  手番でコマを動かした結果、相手のコマが揃ってしまっても負けになる。

3. 画面・UI要件（TRONスタイル）

3.1 レイアウト概要
背景：完全黒 or ダークグラデ（例 #000 → #041）
盤面：
  ネオンブルーの発光ラインで構成
  マスは光る輪のようなデザイン
駒：
  プレイヤー1 → ネオンブルー光球
  プレイヤー2 → ネオングリーン光球

3.2 レスポンシブ仕様
PC：盤面を中央、手持ち駒を左右
スマホ：盤面を縦方向、手持ち駒は上下

3.3 操作UI
駒をタップ／クリックで選択（光が強くなるエフェクト）
選択中のマスが光る
非合法な操作をすると赤い微光で警告

3.4 メッセージ表示
手番表示：「Player 1 / Player 2」（発光）
勝利メッセージ：
  "Player 1 Wins — 光が走る！"
  "Player 2 Wins — 緑の支配！"
ボタンデザイン：ネオンアウトラインボタン
  "NEW GAME（新しいゲーム）"

4. 操作仕様

4.1 駒の操作フロー
手持ち光球をクリック → 選択状態（発光）
盤のマスをクリック → 置く or ゴブリング
自動で手番切り替え

4.2 盤上駒の移動
自分の最上位駒をクリック → 移動元になる
行き先マスをクリック → 移動 or ゴブリング
  （合法なら光の軌跡アニメーション）

4.3 エラー時
アニメで警告（赤い発光）
メッセージ表示

5. システム内部仕様

5.1 データ構造
board[3][3] 形式
各セルは スタック配列で保持（複数駒を管理）
駒オブジェクト例：
  {
    id: 'p1-large-1',
    owner: 'P1',
    size: 'large',
    location: { row: 1, col: 2 } | 'reserve'
  }

5.2 ゲーム状態
currentPlayer
winner
turnCount

5.3 リセット
全駒を手持ち状態に戻す
盤と手番を初期化
発光アニメ解除

5.4 ゲームモード
  2P対戦：同一端末での2人対戦
  vs CPU：コンピューター対戦

5.5 AI対戦（難易度）
  初心者：ランダムに合法手を選択
  中級：基本的な戦略
    - 勝てる手があれば勝つ
    - 負ける手を防ぐ
    - ランダムに駒を配置
  上級：高度な戦略
    - 中級の戦略 +
    - フォーク（2つの勝ち筋を作る）を狙う
    - 相手のフォークをブロック
    - かぶせを活用した戦略
  プロ：最高難易度
    - ミニマックスアルゴリズムまたは高度な評価関数
    - 複数手先を読む
    - スタック構造を活用した高度な戦術

6. 非機能要件

6.1 パフォーマンス
軽量動作
アニメーションはCSSトランジション中心で負荷軽減

6.2 拡張性
将来以下を追加可能な構造にする：
  CPU対戦（簡易AI）
  オンライン対戦
  リプレイ機能（ターン記録）

7. テスト項目

発光UIが正しく反応する
ゴブリングの優先順位が正しい（自分/相手両方の駒にかぶせられる）
駒の数が正しい（各サイズ2個ずつ、計6個）
勝敗判定の精度
選択状態・エラーメッセージが視覚的に伝わる
リセット動作が正常
ゲームモード選択が正しく動作する
AI対戦で各難易度が適切に機能する
AIの思考時間が適切（0.5〜1.5秒程度）
